{
    "contents" : "###Extract UNODC murder rate\nlibrary(XML)\nlibrary(plyr)\nlibrary(googleVis)\nurl <- \"http://en.wikipedia.org/wiki/List_of_countries_by_intentional_homicide_rate\"\npage.doc <- htmlParse(url)\npage.tabs <- readHTMLTable(page.doc)\nMurderRate <- page.tabs[4]\nMurderRate <- ldply(MurderRate)\nMurderRate[1] <- NULL\ncolnames(MurderRate) <- c(\"Country\", \"Rate\", \"Count\", \"Region\", \"Subregion\")\nMurderRate <- subset(MurderRate, Country != \"Country\")\nMurderRate <- arrange(MurderRate, Rate)\nMurderRate[3] <- NULL\nMurderRate[3] <- NULL\nMurderRate[3] <- NULL\nMurderRate$Rate <- as.character(MurderRate$Rate)\nMurderRate$Rate <- as.numeric(MurderRate$Rate)\n\n\npoblacion <- read.csv(\"http://dl.dropboxusercontent.com/s/rkuld1o0lp9zmdn/poblacion.csv?token_hash=AAFiuJOOYN1lZxj9PUhrSnuXH7nZiaBpYFQ0Mn_PL9YrOw&dl=1\")\nmeses1 <- meses\n\nTotalDeaths <- function(Rate){\n  Population2018 <- 124737789\n  FinalDeaths <- Population2018 * Rate / 100000 / 12\n  meses1$homicidios <- 1585\n  rate <- (FinalDeaths - 1585) / 1585\n  rate <- rate / 72\n  meses1$counter <- 0:71\n  meses1$rate <- rate * meses1$counter\n  meses1$homicidios <- meses1$homicidios + ( meses1$rate * meses1$homicidios)\n  meses1[1,3] <- 1585 \n  meses1[72,3] <- FinalDeaths  \n  suma <- sum(meses1$homicidios)\n  return(suma)\n}\n\nTotales <- lapply(MurderRate$Rate, TotalDeaths)\nTotales <- ldply(Totales)\nMurderRate <- data.frame(country=(MurderRate$Country), tasa=(MurderRate$Rate), sumahomicidios=(Totales))\ncolnames(MurderRate) <- c(\"country\", \"tasa\", \"sumahomicidios\")\n\nremove(page.doc, page.tabs, url)\n###GeoChart\n\nG1 <- gvisGeoChart(MurderRate, locationvar = \"country\", colorvar=\"sumahomicidios\", options=list(height=1000, width=1000, colorAxis=\"{minValue: 0,  colors: ['white', 'red']}\"))\nG2 <- gvisGeoChart(MurderRate, locationvar = \"country\", colorvar=\"Diff\", sizevar=\"Tasa\", options=list(height=1000, width=1000, colorAxis=\"{minValue: -20000, maxValue: 20000 ,  colors: ['red' ,'white', 'royalblue']}\"))\n\nMurderRate$Tasa <- 115682868\nMurderRate$Tasa <- MurderRate$tasa * MurderRate$Tasa / 100000\nMurderRate$Diff <- 20554 - MurderRate$Tasa \nMurderRate <- arrange(MurderRate, Diff)\nMurderRate$Diff <- round(MurderRate$Diff, 0)\nMurderRate$Tasa <- round(MurderRate$Tasa, 0)\nMurderRate$tasa <- NULL\nMurderRate$sumahomicidios <- NULL\nformat(12345.678,big.mark=\",\",scientific=F)\nMurderRate$numero <- format(MurderRate$Tasa,big.mark=\",\",scientific=F) \nMurderRate$Label <- paste(\"Hubiéramos tenido\", MurderRate$numero, \"homicidios.\", sep=\" \")\nMurderRate$sign <- as.character(MurderRate$Diff)\nMurderRate$sign <- substr(MurderRate$sign, 0,1)\nMurderRate$sign <- ifelse(MurderRate$sign == \"-\", \"más\", \"menos\")\nMurderRate$numero1 <- abs(MurderRate$Diff)\nMurderRate$numero1 <- format(MurderRate$numero1,big.mark=\",\",scientific=F)\nMurderRate$Label1 <- paste( MurderRate$numero1, \"homicidios\", MurderRate$sign, \"que los ocurridos en 2012.\", sep=\" \")\nMurderRate$numero <- NULL\nMurderRate$numero1 <- NULL\nMurderRate$sign <- NULL\nMurderRate$FinalLabel <- paste( MurderRate$Label, MurderRate$Label1, sep=\" \")\nMurderRate$Diff <- MurderRate$Diff * -1\nMurderRate$Tasa <- NULL\nMurderRate$Label <- NULL\nMurderRate$Label1 <- NULL\n\ntable <- gvisTable(MurderRate)\n\n\n",
    "created" : 1366657581769.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "737360808",
    "id" : "27D395B",
    "lastKnownWriteTime" : 1366662291,
    "path" : "~/R/Estacionalidad/GeoChart.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}